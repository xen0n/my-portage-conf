From a38af72123e71d189cd3932fbdf6a032f110b968 Mon Sep 17 00:00:00 2001
From: Calring <519384449@qq.com>
Date: Wed, 11 Aug 2021 14:35:55 +0800
Subject: [PATCH 12/30] Add some annotation of instruction opcodes and delete
 codes about gcsrxchg.

---
 gas/config/tc-loongarch.c | 18 ++++++++++++------
 1 file changed, 12 insertions(+), 6 deletions(-)

diff --git a/gas/config/tc-loongarch.c b/gas/config/tc-loongarch.c
index fcb223a14c0..1c26187995b 100644
--- a/gas/config/tc-loongarch.c
+++ b/gas/config/tc-loongarch.c
@@ -656,9 +656,12 @@ check_this_insn_before_appending (struct loongarch_cl_insn *ip)
       ip->reloc_num++;
     }
   else if (ip->insn->mask == 0xffff8000 &&
-           ((ip->insn_bin & 0xfff00000) == 0x38600000 ||  /* amswap.w  rd, rk, rj */
-            (ip->insn_bin & 0xffff0000) == 0x38700000 ||  /* ammax_db.wu  rd, rk, rj */
-            (ip->insn_bin & 0xffff0000) == 0x38710000))  /* ammin_db.wu  rd, rk, rj */
+           ((ip->insn_bin & 0xfff00000) == 0x38600000 ||  /* amswap.w  rd, rk,
+                                                             rj */
+            (ip->insn_bin & 0xffff0000) == 0x38700000 ||  /* ammax_db.wu  rd, 
+                                                             rk, rj */
+            (ip->insn_bin & 0xffff0000) == 0x38710000))  /* ammin_db.wu  rd, 
+                                                            rk, rj */
     {
       /* For AMO insn amswap.[wd], amadd.[wd], etc. */
       if (ip->args[0] != 0 &&
@@ -667,15 +670,18 @@ check_this_insn_before_appending (struct loongarch_cl_insn *ip)
           _ ("AMO insns require rd != base && rd != rt when rd isn't $r0"));
     }
   else if ((ip->insn->mask == 0xffe08000 &&
-            (ip->insn_bin & 0xffe00000) == 0x00600000) ||  /* bstrins.w  rd, rj, msbw, lsbw */
+            (ip->insn_bin & 0xffe00000) == 0x00600000) ||  /* bstrins.w  rd, 
+                                                              rj, msbw, lsbw */
            (ip->insn->mask == 0xffc00000 &&
-            (ip->insn_bin & 0xff800000) == 0x00800000))  /* bstrins.d  rd, rj, msbd, lsbd */
+            (ip->insn_bin & 0xff800000) == 0x00800000))  /* bstrins.d  rd, rj, 
+                                                            msbd, lsbd */
     {
       /* For bstr(ins|pick).[wd] */
       if (ip->args[2] < ip->args[3])
         as_fatal (_ ("bstr(ins|pick).[wd] require msbd >= lsbd"));
     }
-  else if (ip->insn->mask != 0 && (ip->insn_bin & 0xfe0003c0) == 0x04000000 && /*  csrxchg  rd, rj, csr_num */
+  else if (ip->insn->mask != 0 && (ip->insn_bin & 0xfe0003c0) == 0x04000000 && 
+        /*  csrxchg  rd, rj, csr_num */
            (strcmp ("csrxchg", ip->name) == 0))
     as_fatal (_ ("csrxchg require rj != $r0 && rj != $r1"));
 
-- 
2.30.1

